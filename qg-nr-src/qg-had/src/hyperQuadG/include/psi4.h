      t1 = abs(chi)
      inv_chi = 0.1D1/t1
      t1 = gtd(1,1)
      t2 = gtd(2,2)
      t4 = gtd(3,3)
      t6 = gtd(2,3)
      t7 = t6**2
      t9 = gtd(1,2)
      t10 = t9**2
      t12 = gtd(1,3)
      t16 = t12**2
      detgtd = t1*t2*t4+2*t9*t12*t6-t1*t7-t10*t4-t16*t2
      idetgtd = 0.1D1/detgtd
      t2 = gtd(2,3)**2
      t14 = gtd(1,3)**2
      t22 = gtd(1,2)**2
      gtu(1,1) = idetgtd*(gtd(2,2)*gtd(3,3)-t2)
      gtu(1,2) = idetgtd*(-gtd(1,2)*gtd(3,3)+gtd(1,3)*gtd(2,3))
      gtu(1,3) = idetgtd*(gtd(1,2)*gtd(2,3)-gtd(1,3)*gtd(2,2))
      gtu(2,1) = gtu(1,2)
      gtu(2,2) = idetgtd*(gtd(1,1)*gtd(3,3)-t14)
      gtu(2,3) = idetgtd*(-gtd(1,1)*gtd(2,3)+gtd(1,2)*gtd(1,3))
      gtu(3,1) = gtu(1,3)
      gtu(3,2) = gtu(2,3)
      gtu(3,3) = idetgtd*(gtd(1,1)*gtd(2,2)-t22)
      t2 = gtu(1,2)*Atd(1,2)
      t3 = gtu(1,3)*Atd(1,3)
      t18 = gtu(2,3)*Atd(2,3)
      Atud(1,1) = gtu(1,1)*Atd(1,1)+t2+t3
      Atud(1,2) = gtu(1,1)*Atd(1,2)+gtu(1,2)*Atd(2,2)+gtu(1,3)*Atd(2,3)
      Atud(1,3) = gtu(1,1)*Atd(1,3)+gtu(1,2)*Atd(2,3)+gtu(1,3)*Atd(3,3)
      Atud(2,1) = gtu(1,2)*Atd(1,1)+gtu(2,2)*Atd(1,2)+gtu(2,3)*Atd(1,3)
      Atud(2,2) = gtu(2,2)*Atd(2,2)+t18+t2
      Atud(2,3) = gtu(1,2)*Atd(1,3)+gtu(2,2)*Atd(2,3)+gtu(2,3)*Atd(3,3)
      Atud(3,1) = gtu(1,3)*Atd(1,1)+gtu(2,3)*Atd(1,2)+gtu(3,3)*Atd(1,3)
      Atud(3,2) = gtu(1,3)*Atd(1,2)+gtu(2,3)*Atd(2,2)+gtu(3,3)*Atd(2,3)
      Atud(3,3) = gtu(3,3)*Atd(3,3)+t18+t3
      Ctd(1,1,1) = d_gtd(1,1,1)
      Ctd(1,1,2) = d_gtd(2,1,1)
      Ctd(1,1,3) = d_gtd(3,1,1)
      Ctd(1,2,1) = Ctd(1,1,2)
      Ctd(1,2,2) = 2*d_gtd(2,1,2)-d_gtd(1,2,2)
      Ctd(1,2,3) = d_gtd(2,1,3)+d_gtd(3,1,2)-d_gtd(1,2,3)
      Ctd(1,3,1) = Ctd(1,1,3)
      Ctd(1,3,2) = Ctd(1,2,3)
      Ctd(1,3,3) = 2*d_gtd(3,1,3)-d_gtd(1,3,3)
      Ctd(2,1,1) = 2*d_gtd(1,1,2)-d_gtd(2,1,1)
      Ctd(2,1,2) = d_gtd(1,2,2)
      Ctd(2,1,3) = d_gtd(1,2,3)+d_gtd(3,1,2)-d_gtd(2,1,3)
      Ctd(2,2,1) = Ctd(2,1,2)
      Ctd(2,2,2) = d_gtd(2,2,2)
      Ctd(2,2,3) = d_gtd(3,2,2)
      Ctd(2,3,1) = Ctd(2,1,3)
      Ctd(2,3,2) = Ctd(2,2,3)
      Ctd(2,3,3) = 2*d_gtd(3,2,3)-d_gtd(2,3,3)
      Ctd(3,1,1) = 2*d_gtd(1,1,3)-d_gtd(3,1,1)
      Ctd(3,1,2) = d_gtd(1,2,3)+d_gtd(2,1,3)-d_gtd(3,1,2)
      Ctd(3,1,3) = d_gtd(1,3,3)
      Ctd(3,2,1) = Ctd(3,1,2)
      Ctd(3,2,2) = 2*d_gtd(2,2,3)-d_gtd(3,2,2)
      Ctd(3,2,3) = d_gtd(2,3,3)
      Ctd(3,3,1) = Ctd(3,1,3)
      Ctd(3,3,2) = Ctd(3,2,3)
      Ctd(3,3,3) = d_gtd(3,3,3)
      Ct(1,1,1) = gtu(1,1)*Ctd(1,1,1)+gtu(1,2)*Ctd(2,1,1)+gtu(1,3)*Ctd(3
     #,1,1)
      Ct(1,1,2) = gtu(1,1)*Ctd(1,1,2)+gtu(1,2)*Ctd(2,1,2)+gtu(1,3)*Ctd(3
     #,1,2)
      Ct(1,1,3) = gtu(1,1)*Ctd(1,1,3)+gtu(1,2)*Ctd(2,1,3)+gtu(1,3)*Ctd(3
     #,1,3)
      Ct(1,2,1) = Ct(1,1,2)
      Ct(1,2,2) = gtu(1,1)*Ctd(1,2,2)+gtu(1,2)*Ctd(2,2,2)+gtu(1,3)*Ctd(3
     #,2,2)
      Ct(1,2,3) = gtu(1,1)*Ctd(1,2,3)+gtu(1,2)*Ctd(2,2,3)+gtu(1,3)*Ctd(3
     #,2,3)
      Ct(1,3,1) = Ct(1,1,3)
      Ct(1,3,2) = Ct(1,2,3)
      Ct(1,3,3) = gtu(1,1)*Ctd(1,3,3)+gtu(1,2)*Ctd(2,3,3)+gtu(1,3)*Ctd(3
     #,3,3)
      Ct(2,1,1) = gtu(1,2)*Ctd(1,1,1)+gtu(2,2)*Ctd(2,1,1)+gtu(2,3)*Ctd(3
     #,1,1)
      Ct(2,1,2) = gtu(1,2)*Ctd(1,1,2)+gtu(2,2)*Ctd(2,1,2)+gtu(2,3)*Ctd(3
     #,1,2)
      Ct(2,1,3) = gtu(1,2)*Ctd(1,1,3)+gtu(2,2)*Ctd(2,1,3)+gtu(2,3)*Ctd(3
     #,1,3)
      Ct(2,2,1) = Ct(2,1,2)
      Ct(2,2,2) = gtu(1,2)*Ctd(1,2,2)+gtu(2,2)*Ctd(2,2,2)+gtu(2,3)*Ctd(3
     #,2,2)
      Ct(2,2,3) = gtu(1,2)*Ctd(1,2,3)+gtu(2,2)*Ctd(2,2,3)+gtu(2,3)*Ctd(3
     #,2,3)
      Ct(2,3,1) = Ct(2,1,3)
      Ct(2,3,2) = Ct(2,2,3)
      Ct(2,3,3) = gtu(1,2)*Ctd(1,3,3)+gtu(2,2)*Ctd(2,3,3)+gtu(2,3)*Ctd(3
     #,3,3)
      Ct(3,1,1) = gtu(1,3)*Ctd(1,1,1)+gtu(2,3)*Ctd(2,1,1)+gtu(3,3)*Ctd(3
     #,1,1)
      Ct(3,1,2) = gtu(1,3)*Ctd(1,1,2)+gtu(2,3)*Ctd(2,1,2)+gtu(3,3)*Ctd(3
     #,1,2)
      Ct(3,1,3) = gtu(1,3)*Ctd(1,1,3)+gtu(2,3)*Ctd(2,1,3)+gtu(3,3)*Ctd(3
     #,1,3)
      Ct(3,2,1) = Ct(3,1,2)
      Ct(3,2,2) = gtu(1,3)*Ctd(1,2,2)+gtu(2,3)*Ctd(2,2,2)+gtu(3,3)*Ctd(3
     #,2,2)
      Ct(3,2,3) = gtu(1,3)*Ctd(1,2,3)+gtu(2,3)*Ctd(2,2,3)+gtu(3,3)*Ctd(3
     #,2,3)
      Ct(3,3,1) = Ct(3,1,3)
      Ct(3,3,2) = Ct(3,2,3)
      Ct(3,3,3) = gtu(1,3)*Ctd(1,3,3)+gtu(2,3)*Ctd(2,3,3)+gtu(3,3)*Ctd(3
     #,3,3)
      CalGamt(1) = 0.5D0*gtu(1,1)*Ct(1,1,1)+0.5D0*gtu(2,2)*Ct(1,2,2)+0.5
     #D0*gtu(3,3)*Ct(1,3,3)+gtu(1,2)*Ct(1,1,2)+gtu(1,3)*Ct(1,1,3)+gtu(2,
     #3)*Ct(1,2,3)
      CalGamt(2) = 0.5D0*gtu(1,1)*Ct(2,1,1)+0.5D0*gtu(2,2)*Ct(2,2,2)+0.5
     #D0*gtu(3,3)*Ct(2,3,3)+gtu(1,2)*Ct(2,1,2)+gtu(1,3)*Ct(2,1,3)+gtu(2,
     #3)*Ct(2,2,3)
      CalGamt(3) = 0.5D0*gtu(1,1)*Ct(3,1,1)+0.5D0*gtu(2,2)*Ct(3,2,2)+0.5
     #D0*gtu(3,3)*Ct(3,3,3)+gtu(1,2)*Ct(3,1,2)+gtu(1,3)*Ct(3,1,3)+gtu(2,
     #3)*Ct(3,2,3)
      t2 = d_chi(1)**2
      t3 = t2*inv_chi
      t14 = CalGamt(1)*d_chi(1)+CalGamt(2)*d_chi(2)+CalGamt(3)*d_chi(3)
      t21 = inv_chi*d_chi(2)*d_chi(1)
      t26 = inv_chi*d_chi(3)
      t27 = t26*d_chi(1)
      t32 = d_chi(2)**2
      t33 = inv_chi*t32
      t37 = t26*d_chi(2)
      t42 = d_chi(3)**2
      t43 = inv_chi*t42
      t47 = gtu(1,1)*(-0.15D1*t3+dd_chi(1,1))+2*gtu(1,2)*(-0.15D1*t21+dd
     #_chi(1,2))+2*gtu(1,3)*(-0.15D1*t27+dd_chi(1,3))+gtu(2,2)*(-0.15D1*
     #t33+dd_chi(2,2))+2*gtu(2,3)*(-0.15D1*t37+dd_chi(2,3))+gtu(3,3)*(-0
     #.15D1*t43+dd_chi(3,3))
      Rpd(1,1) = 0.5D0*dd_chi(1,1)-0.25D0*t3-0.25D0*Ct(1,1,1)*d_chi(1)-0
     #.25D0*Ct(2,1,1)*d_chi(2)-0.25D0*Ct(3,1,1)*d_chi(3)-0.5D0*gtd(1,1)*
     #t14+0.5D0*gtd(1,1)*t47
      Rpd(1,2) = 0.5D0*dd_chi(1,2)-0.25D0*t21-0.25D0*Ct(1,1,2)*d_chi(1)-
     #0.25D0*Ct(2,1,2)*d_chi(2)-0.25D0*Ct(3,1,2)*d_chi(3)-0.5D0*gtd(1,2)
     #*t14+0.5D0*gtd(1,2)*t47
      Rpd(1,3) = 0.5D0*dd_chi(1,3)-0.25D0*t27-0.25D0*Ct(1,1,3)*d_chi(1)-
     #0.25D0*Ct(2,1,3)*d_chi(2)-0.25D0*Ct(3,1,3)*d_chi(3)-0.5D0*gtd(1,3)
     #*t14+0.5D0*gtd(1,3)*t47
      Rpd(2,1) = Rpd(1,2)
      Rpd(2,2) = 0.5D0*dd_chi(2,2)-0.25D0*t33-0.25D0*Ct(1,2,2)*d_chi(1)-
     #0.25D0*Ct(2,2,2)*d_chi(2)-0.25D0*Ct(3,2,2)*d_chi(3)-0.5D0*gtd(2,2)
     #*t14+0.5D0*gtd(2,2)*t47
      Rpd(2,3) = 0.5D0*dd_chi(2,3)-0.25D0*t37-0.25D0*Ct(1,2,3)*d_chi(1)-
     #0.25D0*Ct(2,2,3)*d_chi(2)-0.25D0*Ct(3,2,3)*d_chi(3)-0.5D0*gtd(2,3)
     #*t14+0.5D0*gtd(2,3)*t47
      Rpd(3,1) = Rpd(1,3)
      Rpd(3,2) = Rpd(2,3)
      Rpd(3,3) = 0.5D0*dd_chi(3,3)-0.25D0*t43-0.25D0*Ct(1,3,3)*d_chi(1)-
     #0.25D0*Ct(2,3,3)*d_chi(2)-0.25D0*Ct(3,3,3)*d_chi(3)-0.5D0*gtd(3,3)
     #*t14+0.5D0*gtd(3,3)*t47
      t18 = Ct(1,1,1)*Ctd(1,1,2)
      t19 = Ct(1,1,2)*Ctd(1,1,1)
      t21 = Ct(2,1,1)*Ctd(2,1,2)
      t22 = Ct(2,1,2)*Ctd(1,1,2)
      t24 = Ct(3,1,1)*Ctd(3,1,2)
      t25 = Ct(3,1,2)*Ctd(1,1,3)
      t30 = Ct(1,1,1)*Ctd(1,1,3)
      t31 = Ct(1,1,3)*Ctd(1,1,1)
      t33 = Ct(2,1,1)*Ctd(2,1,3)
      t34 = Ct(2,1,3)*Ctd(1,1,2)
      t36 = Ct(3,1,1)*Ctd(3,1,3)
      t37 = Ct(3,1,3)*Ctd(1,1,3)
      t52 = Ct(1,1,2)*Ctd(1,1,2)
      t54 = Ct(2,1,2)*Ctd(1,2,2)
      t56 = Ct(2,1,2)*Ctd(2,1,2)
      t57 = Ct(3,1,2)*Ctd(1,2,3)
      t59 = Ct(3,1,2)*Ctd(3,1,2)
      t63 = Ct(1,1,2)*Ctd(1,1,3)
      t64 = Ct(1,1,3)*Ctd(1,1,2)
      t66 = Ct(2,1,2)*Ctd(2,1,3)
      t67 = Ct(2,1,3)*Ctd(1,2,2)
      t69 = Ct(3,1,2)*Ctd(3,1,3)
      t70 = Ct(3,1,3)*Ctd(1,2,3)
      t87 = Ct(2,1,2)*Ctd(1,2,3)
      t89 = Ct(2,1,3)*Ctd(2,1,2)
      t90 = Ct(3,1,2)*Ctd(1,3,3)
      t92 = Ct(3,1,3)*Ctd(3,1,2)
      t96 = Ct(1,1,3)*Ctd(1,1,3)
      t98 = Ct(2,1,3)*Ctd(1,2,3)
      t100 = Ct(2,1,3)*Ctd(2,1,3)
      t101 = Ct(3,1,3)*Ctd(1,3,3)
      t103 = Ct(3,1,3)*Ctd(3,1,3)
      t125 = 0.25D0*gtu(2,3)*(2*t63+t64+2*t87+t89+2*t90+t92)+0.25D0*gtu(
     #3,3)*(3*t96+2*t98+t100+2*t101+t103)-0.5D0*gtu(1,1)*dd_gtd(1,1,1,1)
     #-0.1D1*gtu(1,2)*dd_gtd(1,2,1,1)-0.1D1*gtu(1,3)*dd_gtd(1,3,1,1)-0.5
     #D0*gtu(2,2)*dd_gtd(2,2,1,1)-0.1D1*gtu(2,3)*dd_gtd(2,3,1,1)-0.5D0*g
     #tu(3,3)*dd_gtd(3,3,1,1)+0.1D1*d_Gamt(1,1)*gtd(1,1)+0.1D1*d_Gamt(1,
     #2)*gtd(1,2)+0.1D1*d_Gamt(1,3)*gtd(1,3)
      t143 = Ct(1,1,2)*Ctd(2,1,1)
      t145 = Ct(2,1,1)*Ctd(2,2,2)
      t148 = Ct(3,1,2)*Ctd(2,1,3)
      t153 = Ct(1,1,1)*Ctd(1,2,3)
      t154 = Ct(1,1,3)*Ctd(2,1,1)
      t155 = Ct(1,2,3)*Ctd(1,1,1)
      t156 = Ct(2,1,1)*Ctd(2,2,3)
      t157 = Ct(2,2,3)*Ctd(1,1,2)
      t158 = Ct(3,1,1)*Ctd(3,2,3)
      t159 = Ct(3,1,3)*Ctd(2,1,3)
      t160 = Ct(3,2,3)*Ctd(1,1,3)
      t170 = Ct(1,1,2)*Ctd(1,2,2)
      t171 = Ct(1,1,2)*Ctd(2,1,2)
      t172 = Ct(1,2,2)*Ctd(1,1,2)
      t173 = Ct(2,1,2)*Ctd(2,2,2)
      t174 = 2*t173
      t176 = Ct(3,1,2)*Ctd(2,2,3)
      t177 = Ct(3,1,2)*Ctd(3,2,2)
      t182 = Ct(1,1,2)*Ctd(1,2,3)
      t183 = Ct(1,1,3)*Ctd(2,1,2)
      t184 = Ct(1,2,3)*Ctd(1,1,2)
      t185 = Ct(2,1,2)*Ctd(2,2,3)
      t186 = Ct(2,1,3)*Ctd(2,2,2)
      t187 = Ct(2,2,3)*Ctd(1,2,2)
      t188 = Ct(3,1,2)*Ctd(3,2,3)
      t189 = Ct(3,1,3)*Ctd(2,2,3)
      t190 = Ct(3,2,3)*Ctd(1,2,3)
      t199 = Ct(1,1,2)*Ctd(2,1,3)
      t201 = Ct(1,2,2)*Ctd(1,1,3)
      t203 = Ct(3,1,2)*Ctd(2,3,3)
      t209 = Ct(1,1,3)*Ctd(1,2,3)
      t210 = Ct(1,1,3)*Ctd(2,1,3)
      t211 = Ct(1,2,3)*Ctd(1,1,3)
      t212 = Ct(2,1,3)*Ctd(2,2,3)
      t214 = Ct(2,2,3)*Ctd(1,2,3)
      t215 = Ct(3,1,3)*Ctd(2,3,3)
      t216 = Ct(3,1,3)*Ctd(3,2,3)
      t217 = Ct(3,2,3)*Ctd(1,3,3)
      s1 = 0.25D0*CalGamt(1)*(Ctd(1,1,2)+Ctd(2,1,1))+0.25D0*CalGamt(2)*(
     #Ctd(1,2,2)+Ctd(2,1,2))+0.25D0*CalGamt(3)*(Ctd(1,2,3)+Ctd(2,1,3))+0
     #.25D0*gtu(1,1)*(Ct(1,1,1)*Ctd(2,1,1)+Ct(3,1,1)*Ctd(2,1,3)+t18+t19+
     #2*t21+t22+t24+t25)+0.25D0*gtu(1,2)*(Ct(1,1,1)*Ctd(1,2,2)+Ct(1,2,2)
     #*Ctd(1,1,1)+Ct(2,2,2)*Ctd(1,1,2)+Ct(3,1,1)*Ctd(3,2,2)+Ct(3,2,2)*Ct
     #d(1,1,3)+t143+t145+t148+t56)+0.25D0*gtu(1,3)*(t153+t154+t155+t156+
     #t89+t157+t158+t159+t160)
      t221 = s1+0.25D0*gtu(1,2)*(Ct(1,1,1)*Ctd(2,1,2)+Ct(3,1,1)*Ctd(2,2,
     #3)+t145+2*t52+t54+t56+t57+t59)+0.25D0*gtu(2,2)*(Ct(2,2,2)*Ctd(1,2,
     #2)+Ct(3,2,2)*Ctd(1,2,3)+t170+t171+t172+t174+t176+t177)+0.25D0*gtu(
     #2,3)*(t182+t183+t184+t185+t186+t187+t188+t189+t190)+0.25D0*gtu(1,3
     #)*(Ct(1,1,1)*Ctd(2,1,3)+Ct(3,1,1)*Ctd(2,3,3)+t156+t63+t64+t87+t89+
     #t90+t92)+0.25D0*gtu(2,3)*(Ct(1,1,3)*Ctd(1,2,2)+Ct(2,2,2)*Ctd(1,2,3
     #)+Ct(3,1,3)*Ctd(3,2,2)+Ct(3,2,2)*Ctd(1,3,3)+t185+t186+t199+t201+t2
     #03)+0.25D0*gtu(3,3)*(t209+t210+t211+2*t212+t214+t215+t216+t217)
      t246 = -0.5D0*gtu(1,1)*dd_gtd(1,1,1,2)-0.1D1*gtu(1,2)*dd_gtd(1,2,1
     #,2)-0.1D1*gtu(1,3)*dd_gtd(1,3,1,2)-0.5D0*gtu(2,2)*dd_gtd(2,2,1,2)-
     #0.1D1*gtu(2,3)*dd_gtd(2,3,1,2)-0.5D0*gtu(3,3)*dd_gtd(3,3,1,2)+0.5D
     #0*d_Gamt(1,1)*gtd(1,2)+0.5D0*d_Gamt(1,2)*gtd(2,2)+0.5D0*d_Gamt(1,3
     #)*gtd(2,3)+0.5D0*d_Gamt(2,1)*gtd(1,1)+0.5D0*d_Gamt(2,2)*gtd(1,2)+0
     #.5D0*d_Gamt(2,3)*gtd(1,3)
      t263 = Ct(1,1,2)*Ctd(3,1,1)
      t264 = Ct(2,1,2)*Ctd(3,1,2)
      t269 = Ct(1,1,3)*Ctd(3,1,1)
      t272 = Ct(2,1,3)*Ctd(3,1,2)
      t274 = Ct(3,1,1)*Ctd(3,3,3)
      t284 = Ct(1,1,2)*Ctd(3,1,2)
      t285 = Ct(2,1,2)*Ctd(3,2,2)
      t290 = Ct(1,1,2)*Ctd(1,3,3)
      t291 = Ct(1,1,3)*Ctd(3,1,2)
      t293 = Ct(2,1,2)*Ctd(2,3,3)
      t294 = Ct(2,1,3)*Ctd(3,2,2)
      t296 = Ct(3,1,2)*Ctd(3,3,3)
      t307 = Ct(1,1,2)*Ctd(3,1,3)
      t308 = Ct(2,1,2)*Ctd(3,2,3)
      t312 = Ct(1,1,3)*Ctd(1,3,3)
      t313 = Ct(1,1,3)*Ctd(3,1,3)
      t314 = Ct(1,3,3)*Ctd(1,1,3)
      t315 = Ct(2,1,3)*Ctd(2,3,3)
      t316 = Ct(2,1,3)*Ctd(3,2,3)
      t318 = Ct(3,1,3)*Ctd(3,3,3)
      t319 = 2*t318
      s1 = 0.25D0*CalGamt(1)*(Ctd(1,1,3)+Ctd(3,1,1))+0.25D0*CalGamt(2)*(
     #Ctd(1,2,3)+Ctd(3,1,2))+0.25D0*CalGamt(3)*(Ctd(1,3,3)+Ctd(3,1,3))+0
     #.25D0*gtu(1,1)*(Ct(1,1,1)*Ctd(3,1,1)+Ct(2,1,1)*Ctd(3,1,2)+t30+t31+
     #t33+t34+2*t36+t37)+0.25D0*gtu(1,2)*(t153+t263+t155+t156+t264+t157+
     #t158+t69+t160)+0.25D0*gtu(1,3)*(Ct(1,1,1)*Ctd(1,3,3)+Ct(1,3,3)*Ctd
     #(1,1,1)+Ct(2,1,1)*Ctd(2,3,3)+Ct(2,3,3)*Ctd(1,1,2)+Ct(3,3,3)*Ctd(1,
     #1,3)+t103+t269+t272+t274)
      t324 = s1+0.25D0*gtu(1,2)*(Ct(1,1,1)*Ctd(3,1,2)+Ct(2,1,1)*Ctd(3,2,
     #2)+t158+t63+t64+t66+t67+t69+t70)+0.25D0*gtu(2,2)*(t182+t284+t184+t
     #185+t285+t187+2*t188+t190)+0.25D0*gtu(2,3)*(Ct(1,3,3)*Ctd(1,1,2)+C
     #t(2,3,3)*Ctd(1,2,2)+Ct(3,3,3)*Ctd(1,2,3)+t216+t290+t291+t293+t294+
     #t296)+0.25D0*gtu(1,3)*(Ct(1,1,1)*Ctd(3,1,3)+Ct(2,1,1)*Ctd(3,2,3)+t
     #100+t101+t103+t274+2*t96+t98)+0.25D0*gtu(2,3)*(t307+t209+t211+t308
     #+t212+t214+t296+t216+t217)+0.25D0*gtu(3,3)*(Ct(2,3,3)*Ctd(1,2,3)+C
     #t(3,3,3)*Ctd(1,3,3)+t312+t313+t314+t315+t316+t319)
      t349 = -0.5D0*gtu(1,1)*dd_gtd(1,1,1,3)-0.1D1*gtu(1,2)*dd_gtd(1,2,1
     #,3)-0.1D1*gtu(1,3)*dd_gtd(1,3,1,3)-0.5D0*gtu(2,2)*dd_gtd(2,2,1,3)-
     #0.1D1*gtu(2,3)*dd_gtd(2,3,1,3)-0.5D0*gtu(3,3)*dd_gtd(3,3,1,3)+0.5D
     #0*d_Gamt(1,1)*gtd(1,3)+0.5D0*d_Gamt(1,2)*gtd(2,3)+0.5D0*d_Gamt(1,3
     #)*gtd(3,3)+0.5D0*d_Gamt(3,1)*gtd(1,1)+0.5D0*d_Gamt(3,2)*gtd(1,2)+0
     #.5D0*d_Gamt(3,3)*gtd(1,3)
      t365 = Ct(2,2,2)*Ctd(2,1,2)
      t372 = Ct(1,2,3)*Ctd(2,1,1)
      t374 = Ct(2,2,3)*Ctd(2,1,2)
      t376 = Ct(3,2,3)*Ctd(2,1,3)
      t398 = Ct(1,2,2)*Ctd(1,2,3)
      t399 = Ct(1,2,3)*Ctd(2,1,2)
      t401 = Ct(2,2,2)*Ctd(2,2,3)
      t402 = Ct(2,2,3)*Ctd(2,2,2)
      t404 = Ct(3,2,2)*Ctd(3,2,3)
      t405 = Ct(3,2,3)*Ctd(2,2,3)
      t428 = Ct(1,2,3)*Ctd(1,2,3)
      t429 = Ct(1,2,3)*Ctd(2,1,3)
      t431 = Ct(2,2,3)*Ctd(2,2,3)
      t433 = Ct(3,2,3)*Ctd(2,3,3)
      t435 = Ct(3,2,3)*Ctd(3,2,3)
      t457 = 0.25D0*gtu(2,3)*(2*Ct(1,2,2)*Ctd(2,1,3)+Ct(1,2,3)*Ctd(1,2,2
     #)+2*Ct(3,2,2)*Ctd(2,3,3)+Ct(3,2,3)*Ctd(3,2,2)+2*t401+t402)+0.25D0*
     #gtu(3,3)*(t428+2*t429+3*t431+2*t433+t435)-0.5D0*gtu(1,1)*dd_gtd(1,
     #1,2,2)-0.1D1*gtu(1,2)*dd_gtd(1,2,2,2)-0.1D1*gtu(1,3)*dd_gtd(1,3,2,
     #2)-0.5D0*gtu(2,2)*dd_gtd(2,2,2,2)-0.1D1*gtu(2,3)*dd_gtd(2,3,2,2)-0
     #.5D0*gtu(3,3)*dd_gtd(3,3,2,2)+0.1D1*d_Gamt(2,1)*gtd(1,2)+0.1D1*d_G
     #amt(2,2)*gtd(2,2)+0.1D1*d_Gamt(2,3)*gtd(2,3)
      t474 = Ct(3,2,2)*Ctd(3,1,3)
      t478 = Ct(1,2,3)*Ctd(3,1,1)
      t480 = Ct(2,2,3)*Ctd(3,1,2)
      t482 = Ct(3,2,3)*Ctd(3,1,3)
      t498 = Ct(1,2,3)*Ctd(3,1,2)
      t501 = Ct(2,2,3)*Ctd(3,2,2)
      t503 = Ct(3,2,2)*Ctd(3,3,3)
      t508 = Ct(2,2,3)*Ctd(2,1,3)
      t518 = Ct(1,2,3)*Ctd(1,3,3)
      t519 = Ct(1,2,3)*Ctd(3,1,3)
      t521 = Ct(2,2,3)*Ctd(2,3,3)
      t522 = Ct(2,2,3)*Ctd(3,2,3)
      t523 = Ct(2,3,3)*Ctd(2,2,3)
      t524 = Ct(3,2,3)*Ctd(3,3,3)
      t525 = 2*t524
      s1 = 0.25D0*CalGamt(1)*(Ctd(2,1,3)+Ctd(3,1,2))+0.25D0*CalGamt(2)*(
     #Ctd(2,2,3)+Ctd(3,2,2))+0.25D0*CalGamt(3)*(Ctd(2,3,3)+Ctd(3,2,3))+0
     #.25D0*gtu(1,1)*(t63+t263+t154+t66+t264+t89+2*t69+t159)+0.25D0*gtu(
     #1,2)*(Ct(1,2,2)*Ctd(3,1,1)+Ct(2,2,2)*Ctd(3,1,2)+t182+t185+t188+t37
     #2+t374+t376+t474)+0.25D0*gtu(1,3)*(Ct(1,3,3)*Ctd(2,1,1)+Ct(2,3,3)*
     #Ctd(2,1,2)+Ct(3,3,3)*Ctd(2,1,3)+t290+t293+t296+t478+t480+t482)
      t530 = s1+0.25D0*gtu(1,2)*(Ct(2,2,2)*Ctd(2,1,3)+t183+t186+t188+t18
     #9+t201+t284+t285+t474)+0.25D0*gtu(2,2)*(Ct(1,2,2)*Ctd(3,1,2)+Ct(2,
     #2,2)*Ctd(3,2,2)+t398+t399+t401+t402+2*t404+t405)+0.25D0*gtu(2,3)*(
     #Ct(1,2,2)*Ctd(1,3,3)+Ct(1,3,3)*Ctd(2,1,2)+Ct(2,2,2)*Ctd(2,3,3)+Ct(
     #2,3,3)*Ctd(2,2,2)+Ct(3,3,3)*Ctd(2,2,3)+t435+t498+t501+t503)+0.25D0
     #*gtu(1,3)*(t307+t210+t211+t308+t212+t508+t296+t215+t482)+0.25D0*gt
     #u(2,3)*(Ct(1,2,2)*Ctd(3,1,3)+Ct(2,2,2)*Ctd(3,2,3)+t428+t429+2*t431
     #+t433+t435+t503)+0.25D0*gtu(3,3)*(Ct(1,3,3)*Ctd(2,1,3)+Ct(3,3,3)*C
     #td(2,3,3)+t518+t519+t521+t522+t523+t525)
      t555 = -0.5D0*gtu(1,1)*dd_gtd(1,1,2,3)-0.1D1*gtu(1,2)*dd_gtd(1,2,2
     #,3)-0.1D1*gtu(1,3)*dd_gtd(1,3,2,3)-0.5D0*gtu(2,2)*dd_gtd(2,2,2,3)-
     #0.1D1*gtu(2,3)*dd_gtd(2,3,2,3)-0.5D0*gtu(3,3)*dd_gtd(3,3,2,3)+0.5D
     #0*d_Gamt(2,1)*gtd(1,3)+0.5D0*d_Gamt(2,2)*gtd(2,3)+0.5D0*d_Gamt(2,3
     #)*gtd(3,3)+0.5D0*d_Gamt(3,1)*gtd(1,2)+0.5D0*d_Gamt(3,2)*gtd(2,2)+0
     #.5D0*d_Gamt(3,3)*gtd(2,3)
      t579 = Ct(3,3,3)*Ctd(3,1,3)
      t600 = Ct(3,3,3)*Ctd(3,2,3)
      t647 = 0.25D0*gtu(2,3)*(Ct(1,3,3)*Ctd(1,2,3)+2*t519+2*t522+t523+t5
     #25+t600)+0.25D0*gtu(3,3)*(Ct(1,3,3)*Ctd(1,3,3)+2*Ct(1,3,3)*Ctd(3,1
     #,3)+Ct(2,3,3)*Ctd(2,3,3)+2*Ct(2,3,3)*Ctd(3,2,3)+3*Ct(3,3,3)*Ctd(3,
     #3,3))-0.5D0*gtu(1,1)*dd_gtd(1,1,3,3)-0.1D1*gtu(1,2)*dd_gtd(1,2,3,3
     #)-0.1D1*gtu(1,3)*dd_gtd(1,3,3,3)-0.5D0*gtu(2,2)*dd_gtd(2,2,3,3)-0.
     #1D1*gtu(2,3)*dd_gtd(2,3,3,3)-0.5D0*gtu(3,3)*dd_gtd(3,3,3,3)+0.1D1*
     #d_Gamt(3,1)*gtd(1,3)+0.1D1*d_Gamt(3,2)*gtd(2,3)+0.1D1*d_Gamt(3,3)*
     #gtd(3,3)
      s1 = 0.5D0*CalGamt(1)*Ctd(1,1,1)+0.5D0*CalGamt(2)*Ctd(1,1,2)+0.5D0
     #*CalGamt(3)*Ctd(1,1,3)+0.25D0*gtu(1,1)*(3*Ct(1,1,1)*Ctd(1,1,1)+2*C
     #t(2,1,1)*Ctd(1,1,2)+Ct(2,1,1)*Ctd(2,1,1)+2*Ct(3,1,1)*Ctd(1,1,3)+Ct
     #(3,1,1)*Ctd(3,1,1))+0.25D0*gtu(1,2)*(t18+2*t19+t21+2*t22+t24+2*t25
     #)
      Rtd(1,1) = s1+0.25D0*gtu(1,3)*(t30+2*t31+t33+2*t34+t36+2*t37)+0.25
     #D0*gtu(1,2)*(2*Ct(2,1,1)*Ctd(1,2,2)+Ct(2,1,2)*Ctd(2,1,1)+2*Ct(3,1,
     #1)*Ctd(1,2,3)+Ct(3,1,2)*Ctd(3,1,1)+2*t18+t19)+0.25D0*gtu(2,2)*(3*t
     #52+2*t54+t56+2*t57+t59)+0.25D0*gtu(2,3)*(t63+2*t64+t66+2*t67+t69+2
     #*t70)+0.25D0*gtu(1,3)*(2*Ct(2,1,1)*Ctd(1,2,3)+Ct(2,1,3)*Ctd(2,1,1)
     #+2*Ct(3,1,1)*Ctd(1,3,3)+Ct(3,1,3)*Ctd(3,1,1)+2*t30+t31)+t125
      Rtd(1,2) = t221+t246
      Rtd(1,3) = t324+t349
      Rtd(2,1) = Rtd(1,2)
      s1 = 0.5D0*CalGamt(1)*Ctd(2,1,2)+0.5D0*CalGamt(2)*Ctd(2,2,2)+0.5D0
     #*CalGamt(3)*Ctd(2,2,3)+0.25D0*gtu(1,1)*(t52+2*t143+3*t56+2*t148+t5
     #9)+0.25D0*gtu(1,2)*(2*Ct(1,2,2)*Ctd(2,1,1)+2*Ct(3,2,2)*Ctd(2,1,3)+
     #t170+t173+t177+2*t365)
      Rtd(2,2) = s1+0.25D0*gtu(1,3)*(t182+2*t372+t185+2*t374+t188+2*t376
     #)+0.25D0*gtu(1,2)*(Ct(3,2,2)*Ctd(3,1,2)+2*t171+t172+t174+2*t176+t3
     #65)+0.25D0*gtu(2,2)*(Ct(1,2,2)*Ctd(1,2,2)+2*Ct(1,2,2)*Ctd(2,1,2)+3
     #*Ct(2,2,2)*Ctd(2,2,2)+2*Ct(3,2,2)*Ctd(2,2,3)+Ct(3,2,2)*Ctd(3,2,2))
     #+0.25D0*gtu(2,3)*(t398+2*t399+t401+2*t402+t404+2*t405)+0.25D0*gtu(
     #1,3)*(Ct(3,2,3)*Ctd(3,1,2)+t184+2*t185+2*t199+2*t203+t374)+t457
      Rtd(2,3) = t530+t555
      Rtd(3,1) = Rtd(1,3)
      Rtd(3,2) = Rtd(2,3)
      Rtd(3,3) = 0.5D0*CalGamt(1)*Ctd(3,1,3)+0.5D0*CalGamt(2)*Ctd(3,2,3)
     #+0.5D0*CalGamt(3)*Ctd(3,3,3)+0.25D0*gtu(1,1)*(t96+2*t269+t100+2*t2
     #72+3*t103)+0.25D0*gtu(1,2)*(t209+2*t478+t212+2*t480+t216+2*t482)+0
     #.25D0*gtu(1,3)*(2*Ct(1,3,3)*Ctd(3,1,1)+2*Ct(2,3,3)*Ctd(3,1,2)+t312
     #+t315+t318+2*t579)+0.25D0*gtu(1,2)*(2*t291+t211+2*t294+t508+2*t216
     #+t482)+0.25D0*gtu(2,2)*(t428+2*t498+t431+2*t501+3*t435)+0.25D0*gtu
     #(2,3)*(2*Ct(1,3,3)*Ctd(3,1,2)+2*Ct(2,3,3)*Ctd(3,2,2)+t518+t521+t52
     #4+2*t600)+0.25D0*gtu(1,3)*(Ct(2,3,3)*Ctd(2,1,3)+2*t313+t314+2*t316
     #+t319+t579)+t647
      t4 = inv_chi*Rpd(1,1)+Rtd(1,1)
      t5 = m_np_imag(1)
      t6 = t5**2
      t7 = m_np_real(1)
      t8 = t7**2
      t9 = -t6+t8
      t14 = inv_chi*Rpd(2,2)+Rtd(2,2)
      t15 = m_np_imag(2)
      t16 = t15**2
      t17 = m_np_real(2)
      t18 = t17**2
      t19 = -t16+t18
      t24 = inv_chi*Rpd(3,3)+Rtd(3,3)
      t25 = m_np_imag(3)
      t26 = t25**2
      t27 = m_np_real(3)
      t28 = t27**2
      t29 = -t26+t28
      t34 = inv_chi*Rpd(1,2)+Rtd(1,2)
      t37 = -t5*t15+t7*t17
      t43 = inv_chi*Rpd(1,3)+Rtd(1,3)
      t46 = -t5*t25+t7*t27
      t52 = inv_chi*Rpd(2,3)+Rtd(2,3)
      t55 = -t15*t25+t17*t27
      t58 = inv_chi**2
      t59 = Atd(1,1)
      t60 = r_np(1)
      t62 = Atd(1,2)
      t63 = r_np(2)
      t65 = Atd(1,3)
      t66 = r_np(3)
      t68 = t59*t60+t62*t63+t65*t66
      t71 = Atd(2,2)
      t73 = Atd(2,3)
      t75 = t62*t60+t71*t63+t73*t66
      t79 = Atd(3,3)
      t81 = t65*t60+t73*t63+t79*t66
      t85 = d_chi(1)
      t88 = d_chi(2)
      t91 = d_chi(3)
      t95 = t58*(t68*t60+t75*t63+t81*t66+0.3333333333333333D0*trK*chi+0.
     #5D0*t60*t85+0.5D0*t63*t88+0.5D0*t66*t91)
      t109 = t60*t17-t63*t7
      t111 = Ctd(1,1,2)
      t112 = Atud(1,1)
      t115 = Ctd(2,1,2)
      t116 = Atud(2,1)
      t119 = Ctd(3,1,2)
      t120 = Atud(3,1)
      t123 = d_Atd(1,1,2)+0.5D0*t111*t112+0.5D0*t115*t116+0.5D0*t119*t12
     #0
      t126 = Ctd(1,2,2)
      t129 = Ctd(2,2,2)
      t132 = Ctd(3,2,2)
      t135 = d_Atd(1,2,2)+0.5D0*t126*t112+0.5D0*t129*t116+0.5D0*t132*t12
     #0
      t138 = Ctd(1,2,3)
      t141 = Ctd(2,2,3)
      t144 = Ctd(3,2,3)
      t147 = d_Atd(1,2,3)+0.5D0*t138*t112+0.5D0*t141*t116+0.5D0*t144*t12
     #0
      t149 = t7*t123+t17*t135+t27*t147
      t153 = t60*t15-t63*t5
      t157 = t5*t123+t15*t135+t25*t147
      t161 = t60*t27-t66*t7
      t163 = Ctd(1,1,3)
      t166 = Ctd(2,1,3)
      t169 = Ctd(3,1,3)
      t172 = d_Atd(1,1,3)+0.5D0*t163*t112+0.5D0*t166*t116+0.5D0*t169*t12
     #0
      t176 = Ctd(1,3,3)
      t179 = Ctd(2,3,3)
      t182 = Ctd(3,3,3)
      t185 = d_Atd(1,3,3)+0.5D0*t176*t112+0.5D0*t179*t116+0.5D0*t182*t12
     #0
      t187 = t17*t147+t7*t172+t27*t185
      t191 = t60*t25-t66*t5
      t195 = t15*t147+t5*t172+t25*t185
      t197 = -t109
      t199 = Ctd(1,1,1)
      t200 = Atud(1,2)
      t203 = Ctd(2,1,1)
      t204 = Atud(2,2)
      t207 = Ctd(3,1,1)
      t208 = Atud(3,2)
      t211 = d_Atd(2,1,1)+0.5D0*t199*t200+0.5D0*t203*t204+0.5D0*t207*t20
     #8
      t220 = d_Atd(2,1,2)+0.5D0*t111*t200+0.5D0*t115*t204+0.5D0*t119*t20
     #8
      t229 = d_Atd(2,1,3)+0.5D0*t163*t200+0.5D0*t166*t204+0.5D0*t169*t20
     #8
      t231 = t17*t220+t7*t211+t27*t229
      t233 = -t153
      t237 = t15*t220+t5*t211+t25*t229
      t241 = -t66*t17+t63*t27
      t250 = d_Atd(2,2,3)+0.5D0*t138*t200+0.5D0*t141*t204+0.5D0*t144*t20
     #8
      t259 = d_Atd(2,3,3)+0.5D0*t176*t200+0.5D0*t179*t204+0.5D0*t182*t20
     #8
      t261 = t17*t250+t7*t229+t27*t259
      t265 = -t66*t15+t63*t25
      t269 = t15*t250+t5*t229+t25*t259
      t271 = -t161
      t273 = Atud(1,3)
      t276 = Atud(2,3)
      t279 = Atud(3,3)
      t282 = d_Atd(3,1,1)+0.5D0*t199*t273+0.5D0*t203*t276+0.5D0*t207*t27
     #9
      t291 = d_Atd(3,1,2)+0.5D0*t111*t273+0.5D0*t115*t276+0.5D0*t119*t27
     #9
      t300 = d_Atd(3,1,3)+0.5D0*t163*t273+0.5D0*t166*t276+0.5D0*t169*t27
     #9
      t302 = t17*t291+t27*t300+t7*t282
      t304 = -t191
      t308 = t15*t291+t25*t300+t5*t282
      t310 = -t241
      t319 = d_Atd(3,2,2)+0.5D0*t126*t273+0.5D0*t129*t276+0.5D0*t132*t27
     #9
      t328 = d_Atd(3,2,3)+0.5D0*t138*t273+0.5D0*t141*t276+0.5D0*t144*t27
     #9
      t330 = t17*t319+t27*t328+t7*t291
      t332 = -t265
      t336 = t15*t319+t25*t328+t5*t291
      t338 = t109*t149-t153*t157+t161*t187-t191*t195+t197*t231-t233*t237
     #+t241*t261-t265*t269+t271*t302-t304*t308+t310*t330-t332*t336
      t340 = t7*t68
      t341 = t17*t75
      t342 = t27*t81
      t343 = t340+t341+t342
      t345 = 0.5D0*t7*t85
      t347 = 0.5D0*t17*t88
      t349 = 0.5D0*t27*t91
      t352 = t5*t68
      t353 = t15*t75
      t354 = t25*t81
      t355 = t352+t353+t354
      t357 = 0.5D0*t5*t85
      t359 = 0.5D0*t15*t88
      t361 = 0.5D0*t25*t91
      psi4_real = t4*t9+t14*t19+t24*t29+0.2D1*t34*t37+0.2D1*t43*t46+0.2D
     #1*t52*t55+t95*(t59*t9+t71*t19+t79*t29+0.2D1*t62*t37+0.2D1*t65*t46+
     #0.2D1*t73*t55)-inv_chi*t338-t58*(t343*(t345+t347+t349+t340+t341+t3
     #42)-t355*(t357+t359+t361+t352+t353+t354))
      t377 = t15*t7+t5*t17
      t382 = t25*t7+t5*t27
      t387 = t15*t27+t25*t17
      t419 = t109*t157+t153*t149+t161*t195+t191*t187+t197*t237+t233*t231
     #+t241*t269+t265*t261+t271*t308+t304*t302+t310*t336+t332*t330
      psi4_imag = -2*t4*t5*t7-2*t14*t15*t17-2*t24*t25*t27-0.2D1*t34*t377
     #-0.2D1*t43*t382-0.2D1*t52*t387-t95*(2*t59*t5*t7+2*t71*t15*t17+2*t7
     #9*t25*t27+0.2D1*t62*t377+0.2D1*t65*t382+0.2D1*t73*t387)+inv_chi*t4
     #19+t58*(t343*(-t357-t359-t361+t352+t353+t354)+t355*(-t345-t347-t34
     #9+t340+t341+t342))
