      t2 = dg(2,1,1)/2
      t3 = dg(3,1,1)/2
      t4 = dg(4,1,1)/2
      t5 = dg(1,2,2)/2
      t7 = dg(2,1,3)+dg(3,1,2)-dg(1,2,3)
      t8 = dg(2,1,4)+dg(4,1,2)-dg(1,2,4)
      t9 = dg(1,3,3)/2
      t11 = dg(3,1,4)+dg(4,1,3)-dg(1,3,4)
      t12 = dg(1,4,4)/2
      t15 = dg(1,2,3)+dg(3,1,2)-dg(2,1,3)
      t16 = dg(1,2,4)+dg(4,1,2)-dg(2,1,4)
      t18 = dg(3,2,2)/2
      t19 = dg(4,2,2)/2
      t20 = dg(2,3,3)/2
      t22 = dg(3,2,4)+dg(4,2,3)-dg(2,3,4)
      t23 = dg(2,4,4)/2
      t26 = dg(1,2,3)+dg(2,1,3)-dg(3,1,2)
      t27 = dg(1,3,4)+dg(4,1,3)-dg(3,1,4)
      t29 = dg(2,3,4)+dg(4,2,3)-dg(3,2,4)
      t31 = dg(4,3,3)/2
      t32 = dg(3,4,4)/2
      t35 = dg(1,2,4)+dg(2,1,4)-dg(4,1,2)
      t36 = dg(1,3,4)+dg(3,1,4)-dg(4,1,3)
      t38 = dg(2,3,4)+dg(3,2,4)-dg(4,2,3)
      Chd(1,1,1) = dg(1,1,1)/2
      Chd(1,1,2) = t2
      Chd(1,1,3) = t3
      Chd(1,1,4) = t4
      Chd(1,2,1) = t2
      Chd(1,2,2) = dg(2,1,2)-t5
      Chd(1,2,3) = t7/2
      Chd(1,2,4) = t8/2
      Chd(1,3,1) = t3
      Chd(1,3,2) = t7/2
      Chd(1,3,3) = dg(3,1,3)-t9
      Chd(1,3,4) = t11/2
      Chd(1,4,1) = t4
      Chd(1,4,2) = t8/2
      Chd(1,4,3) = t11/2
      Chd(1,4,4) = dg(4,1,4)-t12
      Chd(2,1,1) = dg(1,1,2)-t2
      Chd(2,1,2) = t5
      Chd(2,1,3) = t15/2
      Chd(2,1,4) = t16/2
      Chd(2,2,1) = t5
      Chd(2,2,2) = dg(2,2,2)/2
      Chd(2,2,3) = t18
      Chd(2,2,4) = t19
      Chd(2,3,1) = t15/2
      Chd(2,3,2) = t18
      Chd(2,3,3) = dg(3,2,3)-t20
      Chd(2,3,4) = t22/2
      Chd(2,4,1) = t16/2
      Chd(2,4,2) = t19
      Chd(2,4,3) = t22/2
      Chd(2,4,4) = dg(4,2,4)-t23
      Chd(3,1,1) = dg(1,1,3)-t3
      Chd(3,1,2) = t26/2
      Chd(3,1,3) = t9
      Chd(3,1,4) = t27/2
      Chd(3,2,1) = t26/2
      Chd(3,2,2) = dg(2,2,3)-t18
      Chd(3,2,3) = t20
      Chd(3,2,4) = t29/2
      Chd(3,3,1) = t9
      Chd(3,3,2) = t20
      Chd(3,3,3) = dg(3,3,3)/2
      Chd(3,3,4) = t31
      Chd(3,4,1) = t27/2
      Chd(3,4,2) = t29/2
      Chd(3,4,3) = t31
      Chd(3,4,4) = dg(4,3,4)-t32
      Chd(4,1,1) = dg(1,1,4)-t4
      Chd(4,1,2) = t35/2
      Chd(4,1,3) = t36/2
      Chd(4,1,4) = t12
      Chd(4,2,1) = t35/2
      Chd(4,2,2) = dg(2,2,4)-t19
      Chd(4,2,3) = t38/2
      Chd(4,2,4) = t23
      Chd(4,3,1) = t36/2
      Chd(4,3,2) = t38/2
      Chd(4,3,3) = dg(3,3,4)-t31
      Chd(4,3,4) = t32
      Chd(4,4,1) = t12
      Chd(4,4,2) = t23
      Chd(4,4,3) = t32
      Chd(4,4,4) = dg(4,4,4)/2

      
      Chu(1,1,1) = guu(1,1)*Chd(1,1,1)+guu(1,2)*Chd(2,1,1)+guu(1,3)*Chd(&
     &3,1,1)+guu(1,4)*Chd(4,1,1)
      Chu(1,1,2) = guu(1,1)*Chd(1,1,2)+guu(1,2)*Chd(2,1,2)+guu(1,3)*Chd(&
     &3,1,2)+guu(1,4)*Chd(4,1,2)
      Chu(1,1,3) = guu(1,1)*Chd(1,1,3)+guu(1,2)*Chd(2,1,3)+guu(1,3)*Chd(&
     &3,1,3)+guu(1,4)*Chd(4,1,3)
      Chu(1,1,4) = guu(1,1)*Chd(1,1,4)+guu(1,2)*Chd(2,1,4)+guu(1,3)*Chd(&
     &3,1,4)+guu(1,4)*Chd(4,1,4)
      Chu(1,2,1) = Chu(1,1,2)
      Chu(1,2,2) = guu(1,1)*Chd(1,2,2)+guu(1,2)*Chd(2,2,2)+guu(1,3)*Chd(&
     &3,2,2)+guu(1,4)*Chd(4,2,2)
      Chu(1,2,3) = guu(1,1)*Chd(1,2,3)+guu(1,2)*Chd(2,2,3)+guu(1,3)*Chd(&
     &3,2,3)+guu(1,4)*Chd(4,2,3)
      Chu(1,2,4) = guu(1,1)*Chd(1,2,4)+guu(1,2)*Chd(2,2,4)+guu(1,3)*Chd(&
     &3,2,4)+guu(1,4)*Chd(4,2,4)
      Chu(1,3,1) = Chu(1,1,3)
      Chu(1,3,2) = Chu(1,2,3)
      Chu(1,3,3) = guu(1,1)*Chd(1,3,3)+guu(1,2)*Chd(2,3,3)+guu(1,3)*Chd(&
     &3,3,3)+guu(1,4)*Chd(4,3,3)
      Chu(1,3,4) = guu(1,1)*Chd(1,3,4)+guu(1,2)*Chd(2,3,4)+guu(1,3)*Chd(&
     &3,3,4)+guu(1,4)*Chd(4,3,4)
      Chu(1,4,1) = Chu(1,1,4)
      Chu(1,4,2) = Chu(1,2,4)
      Chu(1,4,3) = Chu(1,3,4)
      Chu(1,4,4) = guu(1,1)*Chd(1,4,4)+guu(1,2)*Chd(2,4,4)+guu(1,3)*Chd(&
     &3,4,4)+guu(1,4)*Chd(4,4,4)
      Chu(2,1,1) = guu(1,2)*Chd(1,1,1)+guu(2,2)*Chd(2,1,1)+guu(2,3)*Chd(&
     &3,1,1)+guu(2,4)*Chd(4,1,1)
      Chu(2,1,2) = guu(1,2)*Chd(1,1,2)+guu(2,2)*Chd(2,1,2)+guu(2,3)*Chd(&
     &3,1,2)+guu(2,4)*Chd(4,1,2)
      Chu(2,1,3) = guu(1,2)*Chd(1,1,3)+guu(2,2)*Chd(2,1,3)+guu(2,3)*Chd(&
     &3,1,3)+guu(2,4)*Chd(4,1,3)
      Chu(2,1,4) = guu(1,2)*Chd(1,1,4)+guu(2,2)*Chd(2,1,4)+guu(2,3)*Chd(&
     &3,1,4)+guu(2,4)*Chd(4,1,4)
      Chu(2,2,1) = Chu(2,1,2)
      Chu(2,2,2) = guu(1,2)*Chd(1,2,2)+guu(2,2)*Chd(2,2,2)+guu(2,3)*Chd(&
     &3,2,2)+guu(2,4)*Chd(4,2,2)
      Chu(2,2,3) = guu(1,2)*Chd(1,2,3)+guu(2,2)*Chd(2,2,3)+guu(2,3)*Chd(&
     &3,2,3)+guu(2,4)*Chd(4,2,3)
      Chu(2,2,4) = guu(1,2)*Chd(1,2,4)+guu(2,2)*Chd(2,2,4)+guu(2,3)*Chd(&
     &3,2,4)+guu(2,4)*Chd(4,2,4)
      Chu(2,3,1) = Chu(2,1,3)
      Chu(2,3,2) = Chu(2,2,3)
      Chu(2,3,3) = guu(1,2)*Chd(1,3,3)+guu(2,2)*Chd(2,3,3)+guu(2,3)*Chd(&
     &3,3,3)+guu(2,4)*Chd(4,3,3)
      Chu(2,3,4) = guu(1,2)*Chd(1,3,4)+guu(2,2)*Chd(2,3,4)+guu(2,3)*Chd(&
     &3,3,4)+guu(2,4)*Chd(4,3,4)
      Chu(2,4,1) = Chu(2,1,4)
      Chu(2,4,2) = Chu(2,2,4)
      Chu(2,4,3) = Chu(2,3,4)
      Chu(2,4,4) = guu(1,2)*Chd(1,4,4)+guu(2,2)*Chd(2,4,4)+guu(2,3)*Chd(&
     &3,4,4)+guu(2,4)*Chd(4,4,4)
      Chu(3,1,1) = guu(1,3)*Chd(1,1,1)+guu(2,3)*Chd(2,1,1)+guu(3,3)*Chd(&
     &3,1,1)+guu(3,4)*Chd(4,1,1)
      Chu(3,1,2) = guu(1,3)*Chd(1,1,2)+guu(2,3)*Chd(2,1,2)+guu(3,3)*Chd(&
     &3,1,2)+guu(3,4)*Chd(4,1,2)
      Chu(3,1,3) = guu(1,3)*Chd(1,1,3)+guu(2,3)*Chd(2,1,3)+guu(3,3)*Chd(&
     &3,1,3)+guu(3,4)*Chd(4,1,3)
      Chu(3,1,4) = guu(1,3)*Chd(1,1,4)+guu(2,3)*Chd(2,1,4)+guu(3,3)*Chd(&
     &3,1,4)+guu(3,4)*Chd(4,1,4)
      Chu(3,2,1) = Chu(3,1,2)
      Chu(3,2,2) = guu(1,3)*Chd(1,2,2)+guu(2,3)*Chd(2,2,2)+guu(3,3)*Chd(&
     &3,2,2)+guu(3,4)*Chd(4,2,2)
      Chu(3,2,3) = guu(1,3)*Chd(1,2,3)+guu(2,3)*Chd(2,2,3)+guu(3,3)*Chd(&
     &3,2,3)+guu(3,4)*Chd(4,2,3)
      Chu(3,2,4) = guu(1,3)*Chd(1,2,4)+guu(2,3)*Chd(2,2,4)+guu(3,3)*Chd(&
     &3,2,4)+guu(3,4)*Chd(4,2,4)
      Chu(3,3,1) = Chu(3,1,3)
      Chu(3,3,2) = Chu(3,2,3)
      Chu(3,3,3) = guu(1,3)*Chd(1,3,3)+guu(2,3)*Chd(2,3,3)+guu(3,3)*Chd(&
     &3,3,3)+guu(3,4)*Chd(4,3,3)
      Chu(3,3,4) = guu(1,3)*Chd(1,3,4)+guu(2,3)*Chd(2,3,4)+guu(3,3)*Chd(&
     &3,3,4)+guu(3,4)*Chd(4,3,4)
      Chu(3,4,1) = Chu(3,1,4)
      Chu(3,4,2) = Chu(3,2,4)
      Chu(3,4,3) = Chu(3,3,4)
      Chu(3,4,4) = guu(1,3)*Chd(1,4,4)+guu(2,3)*Chd(2,4,4)+guu(3,3)*Chd(&
     &3,4,4)+guu(3,4)*Chd(4,4,4)
      Chu(4,1,1) = guu(1,4)*Chd(1,1,1)+guu(2,4)*Chd(2,1,1)+guu(3,4)*Chd(&
     &3,1,1)+guu(4,4)*Chd(4,1,1)
      Chu(4,1,2) = guu(1,4)*Chd(1,1,2)+guu(2,4)*Chd(2,1,2)+guu(3,4)*Chd(&
     &3,1,2)+guu(4,4)*Chd(4,1,2)
      Chu(4,1,3) = guu(1,4)*Chd(1,1,3)+guu(2,4)*Chd(2,1,3)+guu(3,4)*Chd(&
     &3,1,3)+guu(4,4)*Chd(4,1,3)
      Chu(4,1,4) = guu(1,4)*Chd(1,1,4)+guu(2,4)*Chd(2,1,4)+guu(3,4)*Chd(&
     &3,1,4)+guu(4,4)*Chd(4,1,4)
      Chu(4,2,1) = Chu(4,1,2)
      Chu(4,2,2) = guu(1,4)*Chd(1,2,2)+guu(2,4)*Chd(2,2,2)+guu(3,4)*Chd(&
     &3,2,2)+guu(4,4)*Chd(4,2,2)
      Chu(4,2,3) = guu(1,4)*Chd(1,2,3)+guu(2,4)*Chd(2,2,3)+guu(3,4)*Chd(&
     &3,2,3)+guu(4,4)*Chd(4,2,3)
      Chu(4,2,4) = guu(1,4)*Chd(1,2,4)+guu(2,4)*Chd(2,2,4)+guu(3,4)*Chd(&
     &3,2,4)+guu(4,4)*Chd(4,2,4)
      Chu(4,3,1) = Chu(4,1,3)
      Chu(4,3,2) = Chu(4,2,3)
      Chu(4,3,3) = guu(1,4)*Chd(1,3,3)+guu(2,4)*Chd(2,3,3)+guu(3,4)*Chd(&
     &3,3,3)+guu(4,4)*Chd(4,3,3)
      Chu(4,3,4) = guu(1,4)*Chd(1,3,4)+guu(2,4)*Chd(2,3,4)+guu(3,4)*Chd(&
     &3,3,4)+guu(4,4)*Chd(4,3,4)
      Chu(4,4,1) = Chu(4,1,4)
      Chu(4,4,2) = Chu(4,2,4)
      Chu(4,4,3) = Chu(4,3,4)
      Chu(4,4,4) = guu(1,4)*Chd(1,4,4)+guu(2,4)*Chd(2,4,4)+guu(3,4)*Chd(&
     &3,4,4)+guu(4,4)*Chd(4,4,4)
      